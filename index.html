<!doctype html>
<html lang="ru">
<head>
<meta charset="utf-8">
<title>Genially Audio Player Editor</title>

<style>
body{
  margin:0;
  font-family:Arial, sans-serif;
  background:#111;
  color:#fff;
  display:flex;
  height:100vh;
}

#editor{
  width:360px;
  padding:16px;
  background:#1a1a1a;
  box-sizing:border-box;
}

#preview{
  flex:1;
  display:flex;
  align-items:center;
  justify-content:center;
}

label{
  display:block;
  margin-top:12px;
  font-size:13px;
  opacity:.7;
}

input, select, textarea, button{
  width:100%;
  margin-top:6px;
  padding:8px;
  border-radius:8px;
  border:none;
  box-sizing:border-box;
}

textarea{
  height:120px;
  background:#000;
  color:#00ff88;
  font-size:12px;
}

button{
  background:#00ff88;
  color:#000;
  font-weight:bold;
  margin-top:14px;
  cursor:pointer;
}

#code{
  height:200px;
}
</style>
</head>

<body>

<div id="editor">
  <h3>Редактор плеера</h3>

  <label>Цвет акцента</label>
  <input type="color" id="accent" value="#1db954">

  <label>Язык</label>
  <select id="lang">
    <option value="ru">Русский</option>
    <option value="en">English</option>
  </select>

  <label>Обложка (URL)</label>
  <input id="cover" value="https://picsum.photos/300">

  <label>MP3 / GitHub raw ссылки (1 в строке)</label>
  <textarea id="tracks">
https://www.soundhelix.com/examples/mp3/SoundHelix-Song-1.mp3
https://www.soundhelix.com/examples/mp3/SoundHelix-Song-2.mp3
  </textarea>

  <button onclick="update()">Получить код</button>

  <textarea id="code" placeholder="Код для Genially"></textarea>
</div>

<div id="preview"></div>

<script>
function renderPlayer(target, cfg){
  target.innerHTML = `
  <div style="
    width:260px;
    background:rgba(255,255,255,.08);
    backdrop-filter:blur(12px);
    border-radius:20px;
    padding:16px;
    text-align:center;
    font-family:Arial;
    color:white;
  ">
    <img src="${cfg.cover}" style="width:160px;height:160px;border-radius:16px;object-fit:cover">
    <div style="margin-top:8px;font-weight:bold" id="title"></div>

    <input type="range" id="seek" value="0" style="width:100%">

    <div style="margin-top:10px">
      <button id="prev">◀</button>
      <button id="play">▶</button>
      <button id="next">▶▶</button>
    </div>

    <div id="list" style="margin-top:10px;font-size:12px;text-align:left"></div>

    <audio id="audio"></audio>
  </div>
  `;

  const audio = target.querySelector("#audio");
  const title = target.querySelector("#title");
  const seek  = target.querySelector("#seek");
  const play  = target.querySelector("#play");
  const list  = target.querySelector("#list");

  let i = 0;

  function name(u){
    return decodeURIComponent(u.split("/").pop().replace(".mp3",""));
  }

  function load(x, auto){
    i = x;
    audio.src = cfg.tracks[i];
    title.textContent = name(cfg.tracks[i]);
    [...list.children].forEach((e,n)=>e.style.color=n===i?cfg.accent:"#ccc");
    if(auto) audio.play();
  }

  cfg.tracks.forEach((t,idx)=>{
    const d = document.createElement("div");
    d.textContent = name(t);
    d.style.cursor="pointer";
    d.onclick=()=>load(idx,true);
    list.appendChild(d);
  });

  load(0);

  play.onclick=()=>audio.paused?audio.play():audio.pause();
  audio.onplay=()=>play.textContent="❚❚";
  audio.onpause=()=>play.textContent="▶";
  audio.ontimeupdate=()=>seek.value=audio.currentTime/audio.duration*100||0;
  seek.oninput=()=>audio.currentTime=audio.duration*seek.value/100;

  target.querySelector("#prev").onclick=()=>load((i-1+cfg.tracks.length)%cfg.tracks.length,true);
  target.querySelector("#next").onclick=()=>load((i+1)%cfg.tracks.length,true);
}

function update(){
  const cfg = {
    accent: accent.value,
    cover: cover.value,
    tracks: tracks.value.trim().split("\n").filter(Boolean),
  };

  renderPlayer(preview, cfg);

  code.value =
`<div id="GENIALLY_AUDIO"></div>
<script>
(${renderPlayer.toString()})(document.getElementById("GENIALLY_AUDIO"), ${JSON.stringify(cfg)});
<\/script>`;
}

const accent = document.getElementById("accent");
const cover  = document.getElementById("cover");
const tracks = document.getElementById("tracks");
const preview= document.getElementById("preview");
const code   = document.getElementById("code");

update();
</script>

</body>
</html>

<!doctype html>
<html lang="ru">
<head>
<meta charset="utf-8">
<title>Genially Audio Player Editor</title>

<style>
body{
  margin:0;
  font-family:Arial,sans-serif;
  background:#0e0e0e;
  color:#fff;
  display:flex;
  height:100vh;
}

#editor{
  width:360px;
  padding:16px;
  background:#141414;
  box-sizing:border-box;
}

#preview{
  flex:1;
  display:flex;
  align-items:center;
  justify-content:center;
}

label{margin-top:12px;display:block;font-size:13px;opacity:.7}
input,textarea,button{
  width:100%;margin-top:6px;padding:8px;
  border-radius:8px;border:none;
}
textarea{
  height:120px;background:#000;color:#00ff88;font-size:12px
}
button{
  background:#00ff88;color:#000;font-weight:bold;
  margin-top:14px;cursor:pointer
}
#code{height:220px}
</style>
</head>

<body>

<div id="editor">
  <h3>Редактор плеера</h3>

  <label>Цвет акцента</label>
  <input type="color" id="accent" value="#1db954">

  <label>Обложка (URL)</label>
  <input id="cover" value="https://picsum.photos/300">

  <label>MP3 / GitHub raw ссылки (1 в строке)</label>
  <textarea id="tracks">
https://www.soundhelix.com/examples/mp3/SoundHelix-Song-1.mp3
https://www.soundhelix.com/examples/mp3/SoundHelix-Song-2.mp3
https://www.soundhelix.com/examples/mp3/SoundHelix-Song-3.mp3
  </textarea>

  <button onclick="update()">Получить код</button>
  <textarea id="code"></textarea>
</div>

<div id="preview"></div>

<script>
function renderPlayer(target, config){
  target.innerHTML = `
  <div class="gp" style="--accent:${config.accent}">
    <img src="${config.cover}">
    <div class="title">${config.names[0]}</div>
    <input type="range" class="seek" value="0">
    <div class="ctrl">
      <button class="prev">◀</button>
      <button class="play">▶</button>
      <button class="next">▶▶</button>
    </div>
    <div class="list"></div>
    <audio></audio>
  </div>`;

  const a = target.querySelector("audio");
  const play = target.querySelector(".play");
  const seek = target.querySelector(".seek");
  const title = target.querySelector(".title");
  const list = target.querySelector(".list");

  let i = 0;

  function load(x,auto){
    i=x;
    a.src=config.tracks[i];
    title.textContent=config.names[i];
    [...list.children].forEach((e,n)=>e.classList.toggle("active",n===i));
    if(auto) a.play();
  }

  config.names.forEach((n,idx)=>{
    const d=document.createElement("div");
    d.textContent=n;
    d.onclick=()=>load(idx,true);
    list.appendChild(d);
  });

  load(0);

  play.onclick=()=>a.paused?a.play():a.pause();
  a.onplay=()=>play.textContent="❚❚";
  a.onpause=()=>play.textContent="▶";
  a.ontimeupdate=()=>seek.value=a.currentTime/a.duration*100||0;
  seek.oninput=()=>a.currentTime=a.duration*seek.value/100;
  target.querySelector(".next").onclick=()=>load((i+1)%config.tracks.length,true);
  target.querySelector(".prev").onclick=()=>load((i-1+config.tracks.length)%config.tracks.length,true);
}

function update(){
  const accent = accentInput.value;
  const cover = coverInput.value;
  const tracks = tracksInput.value.trim().split("\n").filter(Boolean);
  const names = tracks.map(t=>decodeURIComponent(t.split("/").pop().replace(".mp3","")));

  preview.innerHTML = `
<style>
.gp{
  width:280px;
  background:rgba(255,255,255,.08);
  backdrop-filter:blur(14px);
  border-radius:24px;
  padding:16px;
  color:white;
  font-family:Arial;
}
.gp img{width:100%;border-radius:16px}
.ctrl{display:flex;justify-content:center;gap:12px;margin:10px 0}
.gp button{
  width:42px;height:42px;border-radius:50%;
  border:none;background:var(--accent);cursor:pointer
}
.list{max-height:140px;overflow:auto}
.list div{padding:6px;cursor:pointer;opacity:.7}
.list div.active{color:var(--accent);opacity:1}
</style>
<div id="P"></div>`;

  renderPlayer(
    document.getElementById("P"),
    {accent,cover,tracks,names}
  );

  code.value = `<!-- КОД ДЛЯ GENIALLY -->
<div id="GENIALLY_PLAYER"></div>
<style>/* styles here */</style>
<script>/* self-contained JS here */</script>`;
}

const accentInput=document.getElementById("accent");
const coverInput=document.getElementById("cover");
const tracksInput=document.getElementById("tracks");
const preview=document.getElementById("preview");
const code=document.getElementById("code");

update();
</script>

</body>
</html>

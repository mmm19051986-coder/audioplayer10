<!doctype html>
<html lang="ru">
<head>
<meta charset="utf-8">
<title>Genially Audio Player Editor</title>

<style>
body{
  margin:0;
  font-family:Arial,sans-serif;
  background:#0e0e0e;
  color:#fff;
  display:flex;
  height:100vh;
}

#editor{
  width:360px;
  padding:16px;
  background:#141414;
  box-sizing:border-box;
  overflow:auto;
}

#preview{
  flex:1;
  display:flex;
  align-items:center;
  justify-content:center;
}

label{
  display:block;
  margin-top:14px;
  font-size:13px;
  opacity:.7;
}

input, textarea, button{
  width:100%;
  margin-top:6px;
  padding:8px;
  border-radius:8px;
  border:none;
  box-sizing:border-box;
}

textarea{
  height:120px;
  background:#000;
  color:#00ff88;
  font-size:12px;
}

button{
  background:#00ff88;
  color:#000;
  font-weight:bold;
  cursor:pointer;
  margin-top:14px;
}

#code{height:220px;}
</style>
</head>

<body>

<div id="editor">
  <h3>Редактор плеера</h3>

  <label>Цвет акцента</label>
  <input type="color" id="accent" value="#1db954">

  <label>Обложка (URL)</label>
  <input id="cover" value="https://picsum.photos/300">

  <label>MP3 / GitHub raw ссылки (1 в строке)</label>
  <textarea id="tracks">
https://www.soundhelix.com/examples/mp3/SoundHelix-Song-1.mp3
https://www.soundhelix.com/examples/mp3/SoundHelix-Song-2.mp3
https://www.soundhelix.com/examples/mp3/SoundHelix-Song-3.mp3
  </textarea>

  <button onclick="generate()">Получить код</button>
  <textarea id="code" placeholder="Код для Genially"></textarea>
</div>

<div id="preview"></div>

<script>
function filename(url){
  return decodeURIComponent(url.split('/').pop().replace('.mp3',''));
}

function generate(){
  const accent = accentInput.value;
  const cover  = coverInput.value;
  const tracks = tracksInput.value.trim().split("\n").filter(Boolean);

  const code = `
<div id="GENIALLY_PLAYER"></div>

<style>
#GENIALLY_PLAYER{
  --accent:${accent};
  width:280px;
  font-family:Arial,sans-serif;
}

.gp{
  background:rgba(255,255,255,.08);
  backdrop-filter:blur(14px);
  border-radius:24px;
  padding:16px;
  color:white;
}

.gp img{
  width:100%;
  border-radius:16px;
}

.gp .title{
  margin-top:10px;
  font-weight:bold;
}

.gp .controls{
  display:flex;
  justify-content:center;
  gap:14px;
  margin:12px 0;
}

.gp button{
  width:42px;
  height:42px;
  border-radius:50%;
  border:none;
  background:var(--accent);
  cursor:pointer;
}

.gp input[type=range]{width:100%;}

.playlist{
  margin-top:10px;
  max-height:140px;
  overflow:auto;
  border-top:1px solid rgba(255,255,255,.1);
}

.track{
  padding:6px;
  cursor:pointer;
  font-size:13px;
  opacity:.75;
}

.track.active{
  color:var(--accent);
  opacity:1;
}

.track:hover{background:rgba(255,255,255,.08);}
</style>

<script>
(function(){
  const tracks=${JSON.stringify(tracks)};
  let i=0;

  const root=document.getElementById("GENIALLY_PLAYER");
  root.innerHTML=\`
    <div class="gp">
      <img src="${cover}">
      <div class="title" id="title"></div>

      <input type="range" id="seek" value="0">

      <div class="controls">
        <button id="prev">◀</button>
        <button id="play">▶</button>
        <button id="next">▶▶</button>
      </div>

      <div class="playlist" id="list"></div>
      <audio id="audio"></audio>
    </div>\`;

  const audio=root.querySelector("#audio");
  const play=root.querySelector("#play");
  const seek=root.querySelector("#seek");
  const list=root.querySelector("#list");

  function name(u){return decodeURIComponent(u.split('/').pop().replace('.mp3',''));}

  tracks.forEach((t,idx)=>{
    const d=document.createElement("div");
    d.className="track";
    d.textContent=name(t);
    d.onclick=()=>load(idx,true);
    list.appendChild(d);
  });

  function highlight(){
    [...list.children].forEach((e,n)=>e.classList.toggle("active",n===i));
  }

  function load(x,auto){
    i=x;
    audio.src=tracks[i];
    title.textContent=name(tracks[i]);
    highlight();
    if(auto) audio.play();
  }

  load(0);

  play.onclick=()=>audio.paused?audio.play():audio.pause();
  audio.onplay=()=>play.textContent="❚❚";
  audio.onpause=()=>play.textContent="▶";

  audio.ontimeupdate=()=>seek.value=audio.currentTime/audio.duration*100||0;
  seek.oninput=()=>audio.currentTime=audio.duration*seek.value/100;

  audio.onended=()=>load((i+1)%tracks.length,true);
  prev.onclick=()=>load((i-1+tracks.length)%tracks.length,true);
  next.onclick=()=>load((i+1)%tracks.length,true);
})();
<\/script>
`;

  codeBox.value = code;
  preview.innerHTML = code;
}

const accentInput = document.getElementById("accent");
const coverInput  = document.getElementById("cover");
const tracksInput = document.getElementById("tracks");
const codeBox     = document.getElementById("code");
const preview     = document.getElementById("preview");

generate();
</script>

</body>
</html>
